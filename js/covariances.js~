EA = function(dat,Z,z,i){
    var a = get_a(dat,i);
    var b = get_b(dat,Z,z,i);
    var c = get_c(dat,Z,z,i);
    var d = get_d(dat,Z,z,i);
    var out = [[a,b,0],
	       [b,c,0],
	       [0,0,d]];
    return out;
}

EB = function(dat,S,s,X,x,i){
    var err_xsmsm = Math.pow(get_err_yxmsmsp(dat,X,x,S,s,i),2);
    var err_sxmss = get_zxmss(dat,S,s,X,x)[1];
    var out = [[err_xsmsm,0],
	       [0,err_sxmss]];
    return out;
}

ED = function(dat,S,s,X,x,i){
    var a = get_a(dat,i);
    var b = get_b(dat,S,s,i);
    var c = get_c(dat,S,s,i);
    var d = get_d(dat,S,s,i);
    var y = dat.get_y(X);
    var s2yxmsmsp = get_var_yxmsmsp(dat,X,x,X,y,i);
    var out = [[a,b,0,0],
	       [b,c,0,0],
	       [0,0,d,0],
	       [0,0,0,s2yxmsmsp]];
    return out;
}

EG = function(dat,i){
    var S = dat.get_S();
    var s = dat.get_s(S);
    var a = get_a(dat,i);
    var bs = get_b(dat,S,s,i);
    var cs = get_c(dat,S,s,i);
    var ds = get_d(dat,S,s,i);
    var b7 = get_b(dat,'Sm',147,i);
    var c7 = get_c(dat,'Sm',147,i);
    var d7 = get_d(dat,'Sm',147,i);
    var e = get_e(dat,i);
    var f = get_f(dat,i);
    var g = get_g(dat,S,s,i);
    var h = get_h(dat,S,s,i);
    var ii = get_i(dat,S,s,i);
    var j = get_j(dat,S,s,i);
    var k = get_k(dat,S,s,i);
    var l = Math.pow(dat.get_error('He',4,i),2);
    var out = [[a ,bs,0 ,0,0,0,0,b7,0 ,0],
	       [bs,cs,0 ,0,0,ii,0,0 ,0 ,0],
	       [0 ,0 ,ds,0,0,0,k,0 ,0 ,0],
	       [0 ,0 ,0 ,e,0,0,0,0 ,0 ,0],
	       [0 ,0 ,0 ,0,f,h,0,0 ,0 ,0],
	       [0 ,ii ,0 ,0,h,g,0,0 ,0 ,0],
	       [0 ,0 ,k ,0,0,0,j,0 ,0 ,0],
	       [b7,0 ,0 ,0,0,0,0,c7,0 ,0],
	       [0 ,0 ,0 ,0,0,0,0,0 ,d7,0],
	       [0 ,0 ,0 ,0,0,0,0,0 ,0 ,l]];
    return out;
}

function get_a(dat,i){
    var u = dat.get_y('U');
    return get_var_yxmsmsp(dat,'U',u,'U',238,i);
}

function get_b(dat,Z,z,i){
    var u = dat.get_y('U');
    var Amsmsp = dat.get_signal('U',u,i);
    var Bmsmsp = dat.get_signal(Z,z,i);
    var Cmsmsp = dat.get_signal('U',238,i);
    var err_Cmsmsp = dat.get_error('U',238,i);
    return Amsmsp*Bmsmsp*Math.pow(err_Cmsmsp,2)/Math.pow(Cmsmsp,4);
}

function get_c(dat,Z,z,i){
    return get_var_yxmsmsp(dat,Z,z,'U',238,i);
}

function get_d(dat,Z,z,i){
    return get_zxmss(dat,'U',238,Z,z,i)[1];
}

function get_e(dat,i){
    var v = dat.get_y('Th');
    return get_var_yxmsmsp(dat,'Th',232,'Th',v,i);
}

function get_f(dat,i){
    if (dat.inSpike('Sm')){
	var w = dat.get_y('Sm');
	return get_var_yxmsmsp(dat,'Sm',147,'Sm',w,i);
    } else {
	return 0;
    }
}

function get_g(dat,S,s,i){
    return get_var_yxmsmsp(dat,'Sm',147,S,s,i);
}

function get_cov(A,s2A,B,C){
    return -Math.exp(Math.log(C)+Math.log(s2A)-Math.log(B)-2*Math.log(A));
}

function get_h(dat,S,s,i){
    if (dat.inSpike('Sm')){
	var A = dat.get_signal('Sm',147,i);
	var s2A = Math.pow(dat.get_error('Sm',147,i),2);
	var B = dat.get_signal(S,s,i);
	var w = dat.get_y('Sm');
	var C = dat.get_signal(S,w,i);
	return get_cov(A,s2A,B,C);
    } else {
	return 0;
    }
}

function get_i(dat,S,s,i){
    var A = dat.get_signal(S,s,i);
    var s2A = Math.pow(dat.get_error(S,s,i),2);
    var B = dat.get_signal('U',238,i);
    var C = dat.get_signal('Sm',147,i);
    return get_cov(A,s2A,B,C);
}

function get_j(dat,S,s,i){
    return get_zxmss(dat,S,s,'Sm',147)[1];
}

function get_k(dat,S,s,i){
    var A = dat.get_signal(S,s,i);
    var s2A = Math.pow(dat.get_error(S,s,i),2);
    var B = dat.get_signal('Sm',147,i);
    var C = dat.get_signal('U',238,i);
    return get_cov(A,s2A,B,C);
}
